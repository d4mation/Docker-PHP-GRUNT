<html>
	<body>
		<div>
			<div>
				<div class='input_row'>
					<label for='number_of_exemptions'>Number of Exemptions: </label>
					<input type='number' id='number_of_exemptions_value' placeholder='' value='14'/> 
					<div style ='display: inline-block; width:350px;'>
						<input
							id='number_of_exemptions'
						    type="range"
						    min="0"
						    max="100"
						    step="1"
						    value="14"
						    />
					    </div>
				</div>
				<div class='input_row'>
					<label for='amount_of_income_taxable_by_the_city'>Amount of Income taxable by the City:</label>
					<input type='number' id='amount_of_income_taxable_by_the_city_value' placeholder='' value='1000000'/> 
					<div style ='display: inline-block; width:350px;'>
						<input
							id='amount_of_income_taxable_by_the_city'
						    type="range"
						    min="1"
						    max="1000000"
						    step="1"
						    value="1000000"
						    />
					    </div>
				</div>
				<div class='input_row'>
					<label for='taxable_value_of_your_home'>Taxable Value of your home:</label>
					<input type='number' id='taxable_value_of_your_home_value' placeholder='' value='70000'/> 
					<div style ='display: inline-block; width:350px;'>
						<input
							id='taxable_value_of_your_home'
						    type="range"
						    min="1"
						    max="1000000"
						    step="1"
						    value="70000"
						    />
					    </div>
				</div>
			</div>
			<hr>
			<div id='output'>
				<div style='width: 300px; display:inline-block;'>
					<label>ExemptionsValue:</label>
					<label>TotalTaxableIncome:</label>
					<label>TaxLiability:</label>
					<label>TotalReductionInPropertyTaxesProposed:</label>
					<label>AmountPerBiWeeklyPay:</label>
					<label>AmountPerWeekPay:</label>
					<label>NetEffectOnTaxes:</label>
				</div>
				<div style='width: 150px; display:inline-block;'>
					<span class='output' id='ExemptionsValue_output'></span>
					<span class='output' id='TotalTaxableIncome_output'></span>
					<span class='output' id='TaxLiability_output'></span>
					<span class='output' id='TotalReductionInPropertyTaxesProposed_output'></span>
					<span class='output' id='AmountPerBiWeeklyPay_output'></span>
					<span class='output' id='AmountPerWeekPay_output'></span>
					<span class='output' id='NetEffectOnTaxes_output'></span>
				</div>
			</div>
		</div>
		<style>

			label {
				margin-right: 15px;
			}

			#output  label {
				display: block;
			}
			.output {
				display: block;
			}
			.input_row{
				margin-bottom: 5px;

			}
			
			/*
				Following css generated using: http://danielstern.ca/range.css/#/ 
			*/
			input[type=range] {
			  -webkit-appearance: none;
			  width: 100%;
			  margin: 5.5px 0;
			}
			input[type=range]:focus {
			  outline: none;
			}
			input[type=range]::-webkit-slider-runnable-track {
			  width: 100%;
			  height: 6px;
			  cursor: pointer;
			  box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
			  background: #c7c8c8;
			  border-radius: 1.3px;
			  border: 0.2px solid #010101;
			}
			input[type=range]::-webkit-slider-thumb {
			  box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
			  border: 1px solid #000000;
			  height: 17px;
			  width: 16px;
			  border-radius: 3px;
			  background: #5a955a;
			  cursor: pointer;
			  -webkit-appearance: none;
			  margin-top: -5.7px;
			}
			input[type=range]:focus::-webkit-slider-runnable-track {
			  background: #d4d5d5;
			}
			input[type=range]::-moz-range-track {
			  width: 100%;
			  height: 6px;
			  cursor: pointer;
			  box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
			  background: #c7c8c8;
			  border-radius: 1.3px;
			  border: 0.2px solid #010101;
			}
			input[type=range]::-moz-range-thumb {
			  box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
			  border: 1px solid #000000;
			  height: 17px;
			  width: 16px;
			  border-radius: 3px;
			  background: #5a955a;
			  cursor: pointer;
			}
			input[type=range]::-ms-track {
			  width: 100%;
			  height: 6px;
			  cursor: pointer;
			  background: transparent;
			  border-color: transparent;
			  color: transparent;
			}
			input[type=range]::-ms-fill-lower {
			  background: #babbbb;
			  border: 0.2px solid #010101;
			  border-radius: 2.6px;
			  box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
			}
			input[type=range]::-ms-fill-upper {
			  background: #c7c8c8;
			  border: 0.2px solid #010101;
			  border-radius: 2.6px;
			  box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
			}
			input[type=range]::-ms-thumb {
			  box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
			  border: 1px solid #000000;
			  height: 17px;
			  width: 16px;
			  border-radius: 3px;
			  background: #5a955a;
			  cursor: pointer;
			  height: 6px;
			}
			input[type=range]:focus::-ms-fill-lower {
			  background: #c7c8c8;
			}
			input[type=range]:focus::-ms-fill-upper {
			  background: #d4d5d5;
			}


		</style>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<script>

			/* 
			 * This code was written and produced by Sam Rudloff for the city of East Lansing.
			 */

			/*
			 *   This function styles and formats the currency values.
			 *
			 *   @Param String  key   The Element id to fill with the data.
			 *   @Param Number  value The data to format and place in selected id.
			 *
			 *   @return null
			 */
			function setOutput (key, value){
				$('#' + key).html('$' + value.toFixed(2).toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,"));
			}

			
			/*
			 *   This function calculates and updates the tax values.
			 *
			 *   @return null
			 */
			function calculateTax(){
				// Static Variables.
				var ProposedPropertyTaxMillageReduction = 0.005;
				var ProposedTaxRate = 0.01;
				
				// Get user input.
				var NumberOfExemptions = $('#number_of_exemptions').val();
				var AmountOfIncomeTaxableByTheCity  = $('#amount_of_income_taxable_by_the_city').val();
				var TaxableValueOfYourHome = $('#taxable_value_of_your_home').val();

				if (NumberOfExemptions == 'NaN') {
					NumberOfExemptions = 0;
				} 
				if (AmountOfIncomeTaxableByTheCity == 'NaN') {
					AmountOfIncomeTaxableByTheCity = 0;
				} 
				if (TaxableValueOfYourHome == 'NaN') {
					TaxableValueOfYourHome = 0;
				}
				// Business Logic
				var ExemptionsValue = -NumberOfExemptions * 600;
				var TotalTaxableIncome = AmountOfIncomeTaxableByTheCity - ExemptionsValue;
				var TaxLiability = TotalTaxableIncome * ProposedTaxRate;
				var TotalReductionInPropertyTaxesProposed = TaxableValueOfYourHome * ProposedPropertyTaxMillageReduction;

				// Amount over time
				var AmountPerBiWeeklyPay = (TaxLiability / 26); // 26 bi-weeks in a year round to 2 decimals.
				var AmountPerWeekPay = (TaxLiability / 52); // 52 weeks in a year round to 2 decimals.

				//Final Calulation
				var NetEffectOnTaxes = TaxLiability - TotalReductionInPropertyTaxesProposed;

				// Output formated data to screen.
				setOutput('ExemptionsValue_output', ExemptionsValue);
				setOutput('TotalTaxableIncome_output', TotalTaxableIncome);
				setOutput('TaxLiability_output', TaxLiability);
				setOutput('TotalReductionInPropertyTaxesProposed_output', TotalReductionInPropertyTaxesProposed);
				setOutput('AmountPerBiWeeklyPay_output', AmountPerBiWeeklyPay);
				setOutput('AmountPerWeekPay_output', AmountPerWeekPay);
				setOutput('NetEffectOnTaxes_output', NetEffectOnTaxes);
			}

			// Setup events for sliders.
			$('input[type="range"]').change(function(){
				var NumberOfExemptions = $('#number_of_exemptions').val();
				var AmountOfIncomeTaxableByTheCity  = $('#amount_of_income_taxable_by_the_city').val();
				var TaxableValueOfYourHome = $('#taxable_value_of_your_home').val();
		    	
				// Update display
				$('#number_of_exemptions_value').val(NumberOfExemptions);
				$('#amount_of_income_taxable_by_the_city_value').val(AmountOfIncomeTaxableByTheCity);
		    	$('#taxable_value_of_your_home_value').val(TaxableValueOfYourHome);
				calculateTax();
			});
			$('input[type="range"]').mousemove(function(){
				var NumberOfExemptions = $('#number_of_exemptions').val();
				var AmountOfIncomeTaxableByTheCity  = $('#amount_of_income_taxable_by_the_city').val();
				var TaxableValueOfYourHome = $('#taxable_value_of_your_home').val();
		    	
				// Update display
				$('#number_of_exemptions_value').val(NumberOfExemptions);
				$('#amount_of_income_taxable_by_the_city_value').val(AmountOfIncomeTaxableByTheCity);
		    	$('#taxable_value_of_your_home_value').val(TaxableValueOfYourHome);
				calculateTax();
			});

			// Setup events for inputs
			$('input[type="number"]').change(function(){
				var NumberOfExemptions = parseFloat($('#number_of_exemptions_value').val());
				var AmountOfIncomeTaxableByTheCity  = parseFloat($('#amount_of_income_taxable_by_the_city_value').val());
				var TaxableValueOfYourHome = parseFloat($('#taxable_value_of_your_home_value').val());
		    	
				// Update display
				$('#number_of_exemptions').val(NumberOfExemptions).change();
				$('#amount_of_income_taxable_by_the_city').val(AmountOfIncomeTaxableByTheCity).change();
		    	$('#taxable_value_of_your_home').val(TaxableValueOfYourHome).change();
		    	calculateTax();
			});

			//Inital Load
			calculateTax();

		</script>
	</body>
</html>